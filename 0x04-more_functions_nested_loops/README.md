more c functions and nested loop
